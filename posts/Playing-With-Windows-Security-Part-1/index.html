<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="theme" content="Chirpy v2.7.2"><meta name="generator" content="Jekyll v4.2.0" /><meta property="og:title" content="Playing With Windows Security - Part 1" /><meta name="author" content="Peter Gabaldon" /><meta property="og:locale" content="en" /><meta name="description" content="Windows Authentication." /><meta property="og:description" content="Windows Authentication." /><link rel="canonical" href="https://petergabaldon.github.io/posts/Playing-With-Windows-Security-Part-1/" /><meta property="og:url" content="https://petergabaldon.github.io/posts/Playing-With-Windows-Security-Part-1/" /><meta property="og:site_name" content="Peter Gabaldon" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-02-04T00:00:00+01:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Playing With Windows Security - Part 1" /><meta name="twitter:site" content="@PedroGabaldon" /><meta name="twitter:creator" content="@Peter Gabaldon" /><meta name="google-site-verification" content="n4hbrMWNSEClBGstZ5tfJRPe9iWSPul3FA1_3mEJFgQ" /> <script type="application/ld+json"> {"author":{"@type":"Person","name":"Peter Gabaldon"},"description":"Windows Authentication.","url":"https://petergabaldon.github.io/posts/Playing-With-Windows-Security-Part-1/","@type":"BlogPosting","headline":"Playing With Windows Security - Part 1","dateModified":"2021-06-26T13:27:45+02:00","datePublished":"2021-02-04T00:00:00+01:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://petergabaldon.github.io/posts/Playing-With-Windows-Security-Part-1/"},"@context":"https://schema.org"}</script><title>Playing With Windows Security - Part 1 | Peter Gabaldon</title><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"><link rel="preload" href="/assets/css/post.css" as="style"><link rel="stylesheet" href="/assets/css/post.css"><link rel="preload" as="style" href="/assets/css/lib/bootstrap-toc.min.css"><link rel="stylesheet" href="/assets/css/lib/bootstrap-toc.min.css" /> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script async src="/assets/js/post.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-N6LPQ2XQ6P"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-N6LPQ2XQ6P'); }); </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/avatar/Peter_avatar.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Peter Gabaldon</a></div><div class="site-subtitle font-italic">Cybersecurity blog.</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/tabs/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tabs/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/tabs/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/tabs/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/PeterGabaldon" aria-label="github" class="order-3" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/PedroGabaldon" aria-label="twitter" class="order-4" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['',''].join('@')" aria-label="email" class="order-5" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" class="order-6" > <i class="fas fa-rss"></i> </a> <span class="icon-border order-2"></span> <span id="mode-toggle-wrapper" class="order-1"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>Playing With Windows Security - Part 1</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><p>&nbsp;&nbsp;&nbsp;</p><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Playing With Windows Security - Part 1</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Thu, Feb 4, 2021, 12:00 AM +0100" > Feb 4, 2021 <i class="unloaded">2021-02-04T00:00:00+01:00</i> </span> by <span class="author"> Peter Gabaldon </span></div><div> <span> Updated <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Sat, Jun 26, 2021, 1:27 PM +0200" > Jun 26, 2021 <i class="unloaded">2021-06-26T13:27:45+02:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="3115 words">17 min</span></div></div><div class="post-content"><h1 id="windows-authentication">Windows Authentication.</h1><p>In this first part of Windows hacking we will be covering aspects related on how Windows authentication works. I’m coming from Linux ecosystem so sometimes I will try to compare how Windows works vs how Linux does. If it is your case too, comparing Windows internals with Linux one’s could help you (like it was in my case) to better understand some concepts. At the end, an example of Pass-The-Hash using mimikatz will be shown. This post pretends to be an initial guide to Windows penetration testing and Red Team exercises, understanding some key concepts that helps to comprehend how attacks like Pass-The-Hash works. I plan to analyse the obscure functionality of Windows internals in future posts just for fun and profit ;). In the first part we will study a high level view of how Windows performs authentication to later focuse on the NTLM family.</p><ul><li>Windows Logon<li>Windows Access Tokens<li>Mandatory Integrity Control<li>Single-Sign-On<li>The SAM<li>LM and NT hashes<li>LM, NTLMv1 and NTLMv2 authentication protocols<li>Pass-The-Hash<li>Cracking hashes</ul><h1 id="windows-logon">Windows Logon</h1><h2 id="login-on-linux">Login on Linux</h2><p>In Linux, abstracting the whole PAM process, the authentication is simple. You have users declared in <strong>/etc/passwd</strong>, normally shadow passwords is used, so users hashed passwords are stored in <strong>/etc/shadow</strong>. When you try to login, a user and a password are typed, looking at <strong>/etc/passwd</strong> the login process knows wich hashing algorithm to use and the salt, with that information it can hash your entered password and check that one with the stored one, if they are equal then you are in. Other information needed like user <strong>id</strong>, shell or user home path is read from <strong>/etc/passwd</strong>. Those are regular text files that you can read with <em>cat</em> -having enough permissions, of course-, for example. The login process, that was running as root, will set things accordingly and finally call <strong>setuid</strong> setting the <strong>uid</strong> and <strong>euid</strong> to the <strong>id</strong> of the user that you have logged in in with and <strong>gid</strong> and <strong>geid</strong> to the <strong>gid</strong> of the primary group of the user. There are more things that the login process has to take into account, effective user id, user groups, env variables… But that is for another day, that is a high level view of the whole process. So basically at the end in Linux we only have an integer representing our scope. The id 0, the id of root, whuch is special because each process with and effective id of 0 is privileged and can do whatever they want and the rest of identifiers, which are unprivileged, are used to check permissions with every file.</p><h2 id="login-on-windows">Login on Windows</h2><p>On Windows, <strong>Winlogon</strong> is responsible of the login process. Linux PAM modules are the equivalente of Windows Credential Providers. Each time a user is logged in, a Logon session is created and a corresponding Access Token which is associted to that Logon session. This Access Token object has some interested things, that we will analys it in more detailt in the next chapter. Each logon session creates at least an Access Token. We can list currently logon sessions using Sysinternals’ “logonsessions64.exe”. In the image below an example is given listing currently logon sessions on a Windows 10 machine. As you can see user <strong>Peter</strong> has two interactive sessions while actually this user has logged in once. That is because the UAC and because this user is an Administrator, it will be explained better in <em>Mandatory Integrity Control</em> section. Each session has an id, a LUID -Locally unique identifier-, LSA, the Local Security Authority, uses this information to map each logon session with its credentials stored in memory. Each process created inherit the <em>Acces Token</em> of the process calling <a href="https://docs.microsoft.com/en-us/windows/win32/api/processthreadsapi/nf-processthreadsapi-createprocessa" target="\_blank">CreateProcess</a> or a specific token with <a href="https://docs.microsoft.com/en-us/windows/win32/api/winbase/nf-winbase-createprocesswithtokenw" target="\_blank">CreateProcessWithToken</a>.</p><p><a href="../../assets/img/playing-win-sec/logon-sessions.png" target="\_blank"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="../../assets/img/playing-win-sec/logon-sessions.png" alt="Logon sessions" /></a></p><h2 id="lsa">LSA</h2><p>The Local Security Authority, LSA, is the subsystem that creates and manages this logon sessions, authenticating users, amongs its security information and other data. It is the director of the Windows Authentication system. Among its capabilities:</p><ul><li>Manage local security policy. Like password expiration.<li>Creates access tokens.<li>Provides the necessary services for authentication</ul><h2 id="lsass">LSASS</h2><p>LSASS is the process that actually implements the actions defined on LSA. We can think LSA like the concept or design and LSASS the implementation. Windows supports some types of authentication methods via the <strong>Security Support Provider Interface</strong> or <strong>SSPI</strong>. The SSPI is an API that provides methods of some <strong>Security Support Provider</strong> or <strong>SSP</strong>, in form of DLL, that implements some authentication algorithm. In that manner, using the SSP API, it is possible to the developer to get abstracted of the obscure whole algorithm process using an SSP. Some SSPs are:</p><ul><li>Kerberos. The SSP implementing the Kerberos authentication process.<li>NTLM. This SSP implments the challenge/response NTLM auth algorithms.<li>Digest. This provider implements the Digest Access protocol. Used to authenticate an user by HTTP or SASL. This methods holds the password crypted on memory, but the encryption key is known, so actually it can be considered that Digest stores password in plain text in memory. That’s why Mimikatz sometimes can recover plain text passwords, because the Digest SSP is being used.<li>Secure Channel. The SSP implementing SSL/TLS protocols.<li>Negotiate. SSP used to negotiate an authentication protocol, when it is no sure which one use, client and server need to agreet a common auth method.</ul><p>More info at Microsoft docs <a href="https://docs.microsoft.com/en-us/windows/win32/rpc/security-support-provider-interface-sspi-" target="\_blank">here</a>.</p><p>LSASS creates Logon sessions when a login is verified and create the corresponding access token and Logon session. LSASS is responsible for maintaining this sessions, and each one would have an access token.</p><h1 id="windows-access-tokens">Windows Access Tokens</h1><h2 id="what-are-windows-access-tokens">What are Windows Access Tokens?</h2><p>A <strong>Windows Access Token</strong> is and object structure containing security information of a process scope. An access token has the following remarkable information from a the security point of view (more information at <a href="https://docs.microsoft.com/en-us/windows/win32/secauthz/access-tokens" target="\_blank">Microsoft Docs</a>):</p><ul><li>The SID of the user account.<li>SIDs of the groups the user belongs to.<li>ID identifying the Logon session. (A logon session creates one access token but an access token can be used by various logon sessions).<li>Privileges.<li>If it is an impersonation or a primary token.</ul><p>In Linux everything is a “file”, so tasks suchs as changing the timezone are implemented as files. Normal file permissions checks are used to things like that. <a href="../../assets/img/playing-win-sec/linux-local-time.png" target="\_blank"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="../../assets/img/playing-win-sec/linux-local-time.png" alt="Linux localtime" /></a> To change the localtime, one have to change the <strong>/etc/localtime</strong> symbolic link.</p><p>Windows does not follow that philosophy, that is why we have <strong>Privileges</strong>, system-related actions are divided into privileges and an access token has a list of privileges. <a href="https://docs.microsoft.com/en-us/windows/win32/secauthz/privilege-constants" target="\_blank">Here</a> is a list of all possible privileges. One important to mention is <strong>SE_DEBUG_PRIVILEGE</strong> wich gives the ability to debug another process and thus giving the ability to read its memory, for example. That is how <em>mimikatz</em> can dump the security information stored on <em>lssas.exe</em> process or how some DLL injection techniques writes to other process memory. When accessing a securable object, Windows will use the SID of the user and the SIDs of the groups to check access vs the DACL, when trying to perform a system-related task, like shutting down the computer, privileges will determine.</p><p>A token can be a primaty token or impersonation token, the primary token is the token associated with the process that was inherited at creation time. A process can impersonta another one, it can perform a task with the security context of another one. This can be abused, that is how <em>meterpreter getsystem</em> can elevate to <em>NT Authority\System</em>, for example.</p><p>We can view the security context of a process using <em>Sysinternals Process Explorer</em>. <a href="../../assets/img/playing-win-sec/proc-exp-example.png" target="\_blank"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="../../assets/img/playing-win-sec/proc-exp-example.png" alt="Process explorer example" /></a></p><p>For example, the <em>explorer.exe</em> process with PID 1364 was created through the logon session 55908, that process got a primary access token with the SID of the user Peter, belonging to the groups showed on the image and with some privileges like the one needed for shuting down the computer -although it is currently disabled-.</p><h1 id="mandatory-integrity-control">Mandatory Integrity Control</h1><p>In Windows, addiotanally to permissions we have a form of restricting access to securable objects if a process is not running in the required integrity level. Windows defines four integrity levels: <strong>low, medium, high and system</strong>. The integrity level is just like other groups, the SID corresponding to the integrity level and a flag indicating that is a SID of a integriy level is added to access token groups. That is how UAC is implemented and that is why an administrator user creates to logon sessions although you have logged in once with that user. Both logon sessions creates a similar access token, almost the same except that the unprivileged one has in its groups the SID of the medium integrity control and the other has the SID of the high integrity control. When you create a process, the new process is created with the minimum of the user integrity level and the file integrity level. System integrity level is used by Windows system services and low integrity level is used when running a executable with low intregrity level. Some operationes will fail even with enough permission established in the DACL. Imagine that you try to write a file and you have enough permissions to write it but the file level is marked with high integrity level and the process is running in medium one, as you can imagine, the write will fail. File set its integrity level in an entry in the SACL. The level of a file can be set using “<em>icacls PATH /setintegritylevel L|M|H</em>”.</p><h1 id="single-sign-on">Single-Sign-On</h1><p>Single-Sign-On is a concept widely spreaded, I am sure you have seen at some web page the typical “Log-in with Google”. Single-Sign-On refers to login only once and that access is reused without the needed of reentering the login information at another point. Windows implements it storing credentials in memory, <em>lsass</em> is the director of SSO. So lsass has credentials stored in memory and when trying to login to some network resource, for example, using NTLMv2 authentication, <em>lsass</em> will try to authenticate using the hashes it has stored. That is very powerful, because the cracking of a NT hash is not mandatory, you can use the hash to login to a network resource, this attack is known as <strong>Pass-The-Hash</strong>.</p><h1 id="the-sam">The SAM</h1><p>Linux stores users and information about them in <strong>/etc/passwd</strong> which is just a file that you can read and parse easily because it is just text. Windows stores users information and hashes in the <strong>SAM</strong>, or <strong>Security Account Manager</strong>. The SAM is a special file residing at <em>C:\Windows\system32\config\SAM</em>. This file is encrypted and not accesible, Windows will fail in an attempt to read it even with the necessary permissions. The <strong>SAM</strong> is also encrypted using the <em>SYSKEY</em> that is also encrypted with the <em>BOOTKEY</em>, present in the <strong>SYSTEM</strong> file -<em>C:\Windows\system32\config\SYSTEM</em>-, blocked too so not accesible -except for NT Authority\System, it can access SAM and SYSTEM from the registry mount points, for example using PsExec.exe -i -s cmd it is possible te get a shell as NT Authority\System-. They are mounted at <em>HKLM\SAM</em> and <em>HKLM\SYSTEM</em>, using <strong>reg.exe save HKLM\SAM FILE_NAME_TO_SAVE</strong> with administrator privileges it is possible to save the <strong>SAM</strong>. The same can be used to save <strong>SYSTEM</strong>. Now it is possible to dump the hashes using <strong>secretsdump</strong> of <a href="https://github.com/SecureAuthCorp/impacket/blob/master/examples/secretsdump.py" target="\_blank">impacket</a>, for example. Another aproach is to use tools like <em>pwdump</em>, <em>samdump2</em>, boot to Linux and mount the Windows partition to access those file considering the parition is not Bitlocker-encrypted. Mimikatz is also capable too, this is and example using the <em>kiwi</em> tool. Some techniches are based on file system filter drivers, like <em>pwdump7</em>, other like <em>mimikatz</em> becomes <strong>NT Authority\System</strong> so it can access <strong>SAM</strong> and <strong>SYSTEM</strong> files.</p><pre><code class="language-code">Using 'mimikatz.log' for logfile : OK

mimikatz # coffee

    ( (
     ) )
  .______.
  |      |]
  \      /
   `----'

mimikatz # token::elevate
Token Id  : 0
User name : 
SID name  : NT AUTHORITY\SYSTEM

624	{0;000003e7} 1 D 42128     	NT AUTHORITY\SYSTEM	S-1-5-18	(04g,21p)	Primary
 -&gt; Impersonated !
 * Process Token : {0;0003daa7} 1 F 1817021   	DESKTOP-1L6MJDO\Peter	S-1-5-21-3623154155-2601920244-3614457045-1001	(14g,24p)	Primary
 * Thread Token  : {0;000003e7} 1 D 1958159   	NT AUTHORITY\SYSTEM	S-1-5-18	(04g,21p)	Impersonation (Delegation)

mimikatz # lsadump::sam
Domain : DESKTOP-1L6MJDO
SysKey : 778f94dbe8bd304ee93fc3d1f75ee249
Local SID : S-1-5-21-3623154155-2601920244-3614457045

SAMKey : f2380ff58b02bae7de8f502d9a004cd7

RID  : 000001f4 (500)
User : Administrador

RID  : 000001f5 (501)
User : Invitado

RID  : 000001f7 (503)
User : DefaultAccount

RID  : 000001f8 (504)
User : WDAGUtilityAccount
  Hash NTLM: d6c3cd7ba08dceaabfc1e8bf0277772e

Supplemental Credentials:
* Primary:NTLM-Strong-NTOWF *
    Random Value : 65e1e05750d84270c88a7be57db6c9f2

* Primary:Kerberos-Newer-Keys *
    Default Salt : WDAGUtilityAccount
    Default Iterations : 4096
    Credentials
      aes256_hmac       (4096) : fb0e347db585daa6da7e6debedf7febfab1bf57b68a6476e2dccf432bdcdfeaa
      aes128_hmac       (4096) : 45e55fb7d5c8d75c5d7d428ba25b9ec5
      des_cbc_md5       (4096) : 62e37afd38a816c8

* Packages *
    NTLM-Strong-NTOWF

* Primary:Kerberos *
    Default Salt : WDAGUtilityAccount
    Credentials
      des_cbc_md5       : 62e37afd38a816c8


RID  : 000003e9 (1001)
User : Peter
  Hash NTLM: 7ce21f17c0aee7fb9ceba532d0546ad6

Supplemental Credentials:
* Primary:NTLM-Strong-NTOWF *
    Random Value : 5682742cf07afea3995641c57d910899

* Primary:Kerberos-Newer-Keys *
    Default Salt : DESKTOP-1L6MJDOPeter
    Default Iterations : 4096
    Credentials
      aes256_hmac       (4096) : 216d42d2809357b8a21c99a1a3553751c6035f2c542e2197fb26d365104fdcd7
      aes128_hmac       (4096) : dc7a8cb8c90ded7ae0033e6711d70adf
      des_cbc_md5       (4096) : 523885e0a2fe5b1c
    OldCredentials
      aes256_hmac       (4096) : 546a1f12ede2de2c7ef888e191bd783f61dfb11d57c8cf1ac2ac9a704bccb8fb
      aes128_hmac       (4096) : 04aefe0e7fd029d47bc46c94f8202bec
      des_cbc_md5       (4096) : c7a126b5e37a43f7
    OlderCredentials
      aes256_hmac       (4096) : 546a1f12ede2de2c7ef888e191bd783f61dfb11d57c8cf1ac2ac9a704bccb8fb
      aes128_hmac       (4096) : 04aefe0e7fd029d47bc46c94f8202bec
      des_cbc_md5       (4096) : c7a126b5e37a43f7

* Packages *
    NTLM-Strong-NTOWF

* Primary:Kerberos *
    Default Salt : DESKTOP-1L6MJDOPeter
    Credentials
      des_cbc_md5       : 523885e0a2fe5b1c
    OldCredentials
      des_cbc_md5       : c7a126b5e37a43f7


mimikatz # 
</code></pre><p>The NT hash of the user <strong>Peter</strong> is <strong>7ce21f17c0aee7fb9ceba532d0546ad6</strong>, the Administrator user is disabled and does not have any credentials configured… That is some of the info we have successfully extracted. The <strong>LM</strong> hash is not saved by default in newer Windows versions.</p><h1 id="lm-and-nt-hashes">LM and NT hashes</h1><p>First Windows password hashing algorithm was <strong>LM</strong>, sort of <strong>Lan Manager</strong>, it was developed by Microsoft and IBM around 1985. This hashing algorithm is now out-dated and you should disable it using the group policy or editing the registry, although is disabled by default since Windows Vista. This hashing algorithm with nowadays computation power is easy to crack, that is why it is insecure.</p><h3 id="how-lm-hashing-works">How LM hashing works</h3><p><strong>LM</strong> works that way:</p><ul><li>First of all, the maximum length is 14 chars. The alphabet is ASCII. If the password is less than 14 chars it is padded using null bytes.<li>After trunking to 14 chars, the password is divided in two blocks of 7 chars each.<li>The password is then uppercased.<li>Each part is used as a password to DES-56 bit encrypt the string “KGS!@#$%”.<li>The final hash is this two results concatenated.</ul><p>The ASCII character set is reduced because of uppercasing, if the password contains less than 14 chars null bytes are used, no salt implied so a rainbow attack is possible, you have just to crack two passwords of 7 chars not the 14 chars password… Those are some reasons why <strong>LM</strong> is weak vs dictionary attacks.</p><h2 id="how-nt-hashing-works">How NT hashing works</h2><p><strong>NT</strong> uses uppercase and lowercase characters and it is 128 Unicode -UTF-16 LE- characters long. This is hashed using <em>MD4</em> and the result is the NT hash.</p><h1 id="lm-ntlmv1-and-ntlmv2-authentication-protocols">LM, NTLMv1 and NTLMv2 authentication protocols</h1><p><strong>NTLM</strong> are challenge/response authentication protocols. <strong>LM</strong> and <strong>NTLMv1</strong> are almost the same, execpt the first uses <strong>LM</strong> hashes and NTLMv1 <strong>NT</strong> hashes. Challenge response algorithms prove that a user knows the password and can access a resource without sending the password over the network. Some random bytes are generetad, id est, the challenge -8 bytes in the case of NTLMv1 and NTLMv2-, using this challenge and the password hash some cryptographic operationes are performed on both sides, the client send the response and the server checks that with his one calculated. If they are equal, client has proved he knwos the correct password and the authentication was successful. NTLM responses can be captured using tools like <a href="https://github.com/SpiderLabs/Responder">Responder</a>.</p><h2 id="lm-and-ntlmv1">LM and NTLMv1</h2><p>The following diagram ilustrates how LM/NTLMv1 calculates the response. <a href="../../assets/img/playing-win-sec/ntlmv1-diagram.png" target="\_blank"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="../../assets/img/playing-win-sec/ntlmv1-diagram.png" alt="NTLMv1 diagram" /></a></p><p><strong>LM/NTLMv1</strong> has some weaknesses:</p><ul><li>Any type of salt involved, same hash with same challenge always produce the same response.<li>The three 7-byte parts can be attacked separately. Specially the last is so weak because the last 5 bytes are always null.<li>DES is not strong nowadays</ul><h2 id="ntlmv2">NTLMv2</h2><p>The following diagram ilustrates the flow of calculating the response. <a href="../../assets/img/playing-win-sec/ntlmv2-diagram.png" target="\_blank"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="../../assets/img/playing-win-sec/ntlmv2-diagram.png" alt="NTLMv2 diagram" /></a> NTLMv2 mitigates some of the frailties of NTLMv1. For example, now the same password and same challenges produce differents responses because of timestamp in “Client challenge 2”. This mitigates replay attacks too. Also NTLMv2 is more robusts vs brute force attacks because of using <strong>HMAC-MD5</strong>.</p><h2 id="hardening">Hardening</h2><p>You should disable NTLMv1, LM and LM hashes, a modern Windows ecosystem can use just NT hashes and NTLMv2 (remember LM is enabled by default in Windows XP and Server 2003, versions more recent than them does not come with it enabled by default).</p><h3 id="disabling-lm-hash-using-group-policy">Disabling LM hash using group policy:</h3><ul><li>Run secpol.msc<li>Enable <strong>Network security: Do not store LAN Manager hash value on next password change.</strong> at <strong>Local Policies-&gt;Security Options</strong>.</ul><p><a href="../../assets/img/playing-win-sec/group-policy-no-lm.png" target="\_blank"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="../../assets/img/playing-win-sec/group-policy-no-lm.png" alt="Disabling LM hash" /></a></p><h3 id="disabling-lm-hash-using-a-registry-entry">Disabling LM hash using a registry entry:</h3><ul><li>Create a <strong>NoLMHash</strong> key at <strong>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Lsa</strong></ul><p><a href="../../assets/img/playing-win-sec/registry-no-lm.png" target="\_blank"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="../../assets/img/playing-win-sec/registry-no-lm.png" alt="Disabling LM hash" /></a></p><h3 id="disabling-ntlmv1-and-lm">Disabling NTLMv1 and LM</h3><ul><li>Run secpol.msc<li>Modify <strong>Network Security: LAN Manager authentication level.</strong> at <strong>Local Policies-&gt;Security Options</strong></ul><p><a href="../../assets/img/playing-win-sec/group-policy-no-ntlmv1.png" target="\_blank"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="../../assets/img/playing-win-sec/group-policy-no-ntlmv1.png" alt="Disabling LM and NTLMv1" /></a> There are five levels, described in this <a href="https://docs.microsoft.com/en-us/windows/security/threat-protection/security-policy-settings/network-security-lan-manager-authentication-level#possible-values" target="\_blank">table</a>.</p><p>Also it is possible to establish this policy using the registry, a key <strong>LmCompatibilityLevel</strong> should be created at <strong>HKLM\System\CurrentControlSet\Control\Lsa</strong> with a value between 0-5 as described in the table referenced before.</p><h1 id="pass-the-hash">Pass-The-Hash</h1><p>As explained before in the Single-Sign-On section <strong>lsass</strong> stores credentials in memory, that way performing authentication to a network resource is possible without reentering credentials because <strong>lsass</strong> will try using the one’s it has in memory. Thus, if you pwn a machine and dump hashes and another machine in the network uses the same password you don’t need to crack the hash, that hash can be used to pivot and move laterally -and vertically if the user is privileged on the target machine- on the network performing a <strong>Pass-The-Hash</strong> attack. In the following figure a <strong>Pass-The-Hash</strong> example using <strong>mimikatz</strong> is performed from the attacker machine. Remember that we dumped the user <strong>Peter</strong> NT hash previously: 7ce21f17c0aee7fb9ceba532d0546ad6.</p><p><a href="../../assets/img/playing-win-sec/mimikatz-pth.gif" target="\_blank"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="../../assets/img/playing-win-sec/mimikatz-pth.gif" alt="Pass-The-Hash with mimikatz" /></a></p><p>Mimikatz inyected at <strong>lsass</strong> memory the credentials of ther user <strong>Peter</strong> and launched a new cmd with that access token, when trying to list the C drive in the background the NTLM authentication took place and because we have the correct NT hash NTLM authentication was successful, listing the contents of the C drive and viwing the content of “test.txt”.</p><h1 id="cracking-hashes">Cracking hashes</h1><p>Famous bruteforce tools like <strong>Hashcat</strong> or <strong>John the Ripper</strong> can crack hashes or NTLM authentication responses.</p><p><strong>Hashcat</strong> example of cracking the NT hash of user <strong>Peter</strong>: <a href="../../assets/img/playing-win-sec/hashcat-crack.png" target="\_blank"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="../../assets/img/playing-win-sec/hashcat-crack.png" alt="Hashcat crack example" /></a></p><p><strong>John</strong> example of cracking the NT hash of user <strong>Peter</strong>: <a href="../../assets/img/playing-win-sec/john-crack.png" target="\_blank"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="../../assets/img/playing-win-sec/john-crack.png" alt="John crack example" /></a></p><h1 id="conclusion">Conclusion</h1><p>Having a hash on a Windows environment with NTLM authentication enabled is almost always equivalent to having a password, PTH is so effective to perform lateral movement on a Windows network and even escalate privileges if some user with higher privileges is reusing a password. In the next part we will study Kerberos key concepts and attacks to that authentication protocol: Overpass-The-Hash, Pass-The-Ticket, Golden Ticket, Silver Ticket, Kerberoasting and AS-Reproasting.</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/en/'>en</a>, <a href='/categories/windows-security/'>Windows security</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/windows/" class="post-tag no-text-decoration" >windows</a> <a href="/tags/cybersecurity/" class="post-tag no-text-decoration" >cybersecurity</a> <a href="/tags/mimikatz/" class="post-tag no-text-decoration" >mimikatz</a> <a href="/tags/pass-the-hash/" class="post-tag no-text-decoration" >pass-the-hash</a> <a href="/tags/red-team/" class="post-tag no-text-decoration" >red team</a> <a href="/tags/pentesting/" class="post-tag no-text-decoration" >pentesting</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Playing With Windows Security - Part 1 - Peter Gabaldon&url=https://petergabaldon.github.io/posts/Playing-With-Windows-Security-Part-1/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Playing With Windows Security - Part 1 - Peter Gabaldon&u=https://petergabaldon.github.io/posts/Playing-With-Windows-Security-Part-1/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Playing With Windows Security - Part 1 - Peter Gabaldon&url=https://petergabaldon.github.io/posts/Playing-With-Windows-Security-Part-1/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/FortiGate-VPN-SSL-Honeypot/">FortiGate VPN-SSL Honeypot</a><li><a href="/posts/Bypass-Azure-Admin-Approval-Mode-Enumeration/">Bypass Azure Admin Approval Mode for User Consent Workflow When Enumerating</a><li><a href="/posts/Finding-TeamViewer-0days-Part-1/">Finding TeamViewer 0days - Part I</a><li><a href="/posts/Finding-TeamViewer-0days-Part-3/">Finding TeamViewer 0days - Part III</a><li><a href="/posts/Diamond-And-Sapphire-Tickets/">Diamond And Sapphire Tickets</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/cybersecurity/">cybersecurity</a> <a class="post-tag" href="/tags/pentesting/">pentesting</a> <a class="post-tag" href="/tags/red-team/">red team</a> <a class="post-tag" href="/tags/windows/">windows</a> <a class="post-tag" href="/tags/cve-2024-7479/">CVE-2024-7479</a> <a class="post-tag" href="/tags/cve-2024-7481/">CVE-2024-7481</a> <a class="post-tag" href="/tags/kerberos/">kerberos</a> <a class="post-tag" href="/tags/tv-2024-1006/">tv-2024-1006</a> <a class="post-tag" href="/tags/zdi-24-1289/">ZDI-24-1289</a> <a class="post-tag" href="/tags/zdi-24-1290/">ZDI-24-1290</a></div></div></div><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/Playing-With-Windows-Security-Part-2/"><div class="card-body"> <span class="timeago small" > Feb 21, 2021 <i class="unloaded">2021-02-21T00:00:00+01:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Playing With Windows Security - Part 2</h3><div class="text-muted small"><p> Kerberos Authentication Protocol After the first part at which we talked about authentication in Windows and explained how attacks like Pass-The-Hash works. At this part we are going to analyse Ke...</p></div></div></a></div><div class="card"> <a href="/posts/Diamond-And-Sapphire-Tickets/"><div class="card-body"> <span class="timeago small" > Oct 14, 2022 <i class="unloaded">2022-10-14T00:00:00+02:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Diamond And Sapphire Tickets</h3><div class="text-muted small"><p> Kerberos Diamond and Sapphire Tickets As you may known, one of the approaches for persistence in a Windows Active Directory are the well-known techniques Golden Ticket and Silver Ticket. In the po...</p></div></div></a></div><div class="card"> <a href="/posts/Finding-TeamViewer-0days-Part-1/"><div class="card-body"> <span class="timeago small" > Oct 4, 2024 <i class="unloaded">2024-10-04T00:00:00+02:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Finding TeamViewer 0days - Part I</h3><div class="text-muted small"><p> Finding TeamViewer 0days. Part 1: The story begins This series of blog posts are about some findings related to TeamViewer (TV) IPC communication with its SYSTEM service. I was trying to find some...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <span class="btn btn-outline-primary disabled"><p>-</p></span> <a href="/posts/Playing-With-Windows-Security-Part-2/" class="btn btn-outline-primary"><p>Playing With Windows Security - Part 2</p></a></div></div></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script> <script type="text/javascript"> const imgs = document.querySelectorAll('.post-content img'); const observer = lozad(imgs); observer.observe(); </script><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2025 <a href="https://twitter.com/PeterGabaldon">Pedro Gabaldon</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy/" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-xl-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/cybersecurity/">cybersecurity</a> <a class="post-tag" href="/tags/pentesting/">pentesting</a> <a class="post-tag" href="/tags/red-team/">red team</a> <a class="post-tag" href="/tags/windows/">windows</a> <a class="post-tag" href="/tags/cve-2024-7479/">CVE 2024 7479</a> <a class="post-tag" href="/tags/cve-2024-7481/">CVE 2024 7481</a> <a class="post-tag" href="/tags/kerberos/">kerberos</a> <a class="post-tag" href="/tags/tv-2024-1006/">tv 2024 1006</a> <a class="post-tag" href="/tags/zdi-24-1289/">ZDI 24 1289</a> <a class="post-tag" href="/tags/zdi-24-1290/">ZDI 24 1290</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://petergabaldon.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"><div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>{categories}</div><div><i class="fa fa-tag fa-fw"></i>{tags}</div></div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>' }); </script>
